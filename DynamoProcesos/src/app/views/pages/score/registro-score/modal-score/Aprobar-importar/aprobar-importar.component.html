<div style="display: flex">
  <div class="flex-1"></div>
  <div class="modal-title c-male" *ngIf="this.DATA_SCORE.scoreObsForm.id_estado_m != 5">Importar evidencia y Aprobar</div>
  <div class="flex-1"></div>

  <button (click)="close()" class="icon-btn btn-trans c-orange moda-close-btn">
    <mat-icon>close</mat-icon>
  </button>
</div>

<ng-container ></ng-container>
<form class="row g-3" [formGroup]="importForm" style="padding: 10px" *ngIf="this.DATA_SCORE.scoreObsForm.id_estado_m != 5">
  <div class="col-sm-12 cli-form-element">
    <label>Nombre Evidencia</label>
    <input
      type="text"
      class="form-control cli-input-white"
      formControlName="nombre"
    />
    <small class="text-alert" *ngIf="campoNoValido('nombre')">* El Nombre de la evidencia es obligatorio</small>
  </div>

  <div class="col-sm-9 cli-form-element">
    <label>Importar evidencia (PDF).</label>
    <input
      type="file"
      class="cli-import"
      accept="image/*"
      formControlName="archivo"
      (change)="onChange($event)"
    />
    <small class="text-alert" *ngIf="campoNoValido('archivo')">* El importar archivo es obligatorio</small>
  </div>

  <div class="col-sm-3">
    <div class="cli-pdf" *ngIf="this.DATA_SCORE.scoreObsForm.id_estado_m != 5">
      <button *ngIf="this.DATA_SCORE.scoreObsForm.id_estado_m == 2"
        class="cli-btn btn-m-pdf btn-purple"
        matTooltip="Importar Máx 4 Pdf"
        (click)="guardarEvidencia()"
        [disabled]="importForm.invalid"
        >
        <mat-icon class="icon-18">save</mat-icon> Guardar
      </button>
    </div>
  </div>
  <!-- [disabled]="esIgualTotalEvidencia()" -->
  <div class="mb-3 form-check" *ngIf="status">
    {{ status.message }}
  </div>
</form>
<!-- LISTA DE PDF ------------------------------------------------------------------------->
<div style="color: #6c757d">
  <!-- <div style="color: #6c757d" *ngIf="this.DATA_SCORE.scoreObsForm.id_estado_m == 5"> -->
  <div class="pr-subtitle mt-2">Listado de Evidencias Score</div>
  <div class="pr-module-container">
    <div style="overflow: auto; min-height: 160px; max-height: 160px">
      <table class="cli-table stripedtable underlinedtable">
        <thead>
          <tr class="bgc-variable c-white">
            <th>#</th>
            <th>Nombre Evidencia</th>
            <th>Archivo PDF</th>
            <th>Link</th>
            <th>Descargar</th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let evidencia of listEvidencias; let i = index">
            <td>{{ i + 1 }}</td>
            <td>{{ evidencia.nombre }}</td>
            <td><img style="height: 80px; width: 100px;"
                [src]="imgBaseUrl+evidencia.imagen">
            </td>
            <td>{{ evidencia.archivo }}</td>
            <td class="w300">
              <div class="cli-table-actions">
                <button matTooltip="Descargar"
                  class="icon-btn btn-trans c-cyan-pdf"
                  (click)="descargarPdf(evidencia)"
                  ><mat-icon class="icon-13">picture_as_pdf</mat-icon>
                </button>

                <button matTooltip="Eliminar" *ngIf="!authService.esUsuarioGestor()"
                  class="icon-btn btn-trans c-fucsia"
                  (click)="descargarPdf(evidencia)"
                  ><mat-icon class="icon-13">delete_forever</mat-icon>
              </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
      <div class="cli-loader" *ngIf="loadingItem">
        <mat-spinner style="margin-right: 20px" diameter="20"></mat-spinner
        >cargando...
      </div>

      <!-- <div *ngIf="!loadingItem && listEvidencias.length == 0"
        class="cli-loader mt-2"
        style="color: #c9c9c9">
        Aquí se mostrará la lista de evidencias del Lider...
      </div> -->
    </div>
  </div>
</div>

<div class="cli-form-buttons" *ngIf="this.DATA_SCORE.scoreObsForm.id_estado_m != 5">
  <button *ngIf="this.DATA_SCORE.scoreObsForm.id_estado_m == 2 || this.DATA_SCORE.scoreObsForm.id_estado_m == 3"
    class="cli-btn btn-m btn-lemon-green"
    matTooltip="Cuidado!, se aprobará la Solicitud"
    style="margin-top: 2%"
    (click)="aprobarSolicitud()"
    [disabled]="importForm.invalid"
    >
    <!-- (click)="existeEvidencia()" -->
    <mat-icon class="icon-18">check</mat-icon> Aprobar
  </button>
</div>
